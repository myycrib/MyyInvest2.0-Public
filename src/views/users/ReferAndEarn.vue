<template>
  <!-- eslint-disable -->
  <div class="refer-container">
    <div class="ref-user">
      <div class="ref-user__col">
        <div class="ref-user__main">
          <div>
            <h5 class="ref-user__page-title">Refer and Earn</h5>
            <div>
              <p class="ref-user__alt-text">Total Referral Amount</p>
              <p class="ref-user__amount">
                <svg xmlns="http://www.w3.org/2000/svg" width="44.673" height="36.855" viewBox="0 0 44.673 36.855" class="ref-user__naira">
                  <g id="Group_19" data-name="Group 19" transform="translate(-422.739 -266.504)">
                    <g id="Group_18" data-name="Group 18">
                      <g id="Group_17" data-name="Group 17">
                        <path
                          id="Path_12"
                          data-name="Path 12"
                          d="M456.174,303.359a5.041,5.041,0,0,1-1.712-.273,4.323,4.323,0,0,1-1.414-.862,8.5,8.5,0,0,1-1.249-1.406c-.392-.549-.785-1.107-1.164-1.661l-5.2-7.965h-8.8v8.168a4.361,4.361,0,0,1-.911,3,2.98,2.98,0,0,1-2.328,1,2.941,2.941,0,0,1-2.349-1.008,4.436,4.436,0,0,1-.891-2.99v-8.168h-5.035a2.389,2.389,0,0,1,0-4.778h5.035v-4.077h-5.035a2.389,2.389,0,1,1,0-4.777h5.035v-5.953a7.712,7.712,0,0,1,.372-2.686,3.771,3.771,0,0,1,1.49-1.746,4,4,0,0,1,2.238-.671,3.872,3.872,0,0,1,1.609.3,3.831,3.831,0,0,1,1.175.823A8.7,8.7,0,0,1,438.1,269c.369.573.749,1.17,1.152,1.807l4.463,6.753h9.854V270.5a4.556,4.556,0,0,1,.854-3.017,2.834,2.834,0,0,1,2.287-.983,2.928,2.928,0,0,1,2.349.985,4.507,4.507,0,0,1,.865,3.015v7.056h5.1a2.389,2.389,0,0,1,0,4.778h-5.1v4.077h5.1a2.388,2.388,0,1,1,0,4.777h-5.1v7.6C459.928,301.867,458.7,303.359,456.174,303.359Zm-20.32-13.744h10.013a.788.788,0,0,1,.66.358l5.42,8.309c.362.531.75,1.08,1.134,1.619a7.049,7.049,0,0,0,1.019,1.148,2.72,2.72,0,0,0,.9.554,3.442,3.442,0,0,0,1.177.181c.919,0,2.178,0,2.178-2.987V290.4a.789.789,0,0,1,.788-.789h5.884a.812.812,0,1,0,0-1.624H459.14a.789.789,0,0,1-.789-.788v-5.654a.789.789,0,0,1,.789-.788h5.883a.812.812,0,0,0,0-1.624H459.14a.789.789,0,0,1-.789-.788V270.5a2.983,2.983,0,0,0-.478-1.98,1.355,1.355,0,0,0-1.159-.444,1.285,1.285,0,0,0-1.091.434,3.043,3.043,0,0,0-.473,1.989v7.845a.789.789,0,0,1-.788.789H443.3a.788.788,0,0,1-.658-.354l-4.7-7.119c-.411-.647-.789-1.24-1.155-1.81a7.123,7.123,0,0,0-.861-1.122,2.261,2.261,0,0,0-.7-.49,2.366,2.366,0,0,0-.953-.162,2.441,2.441,0,0,0-1.381.418,2.2,2.2,0,0,0-.886,1.017,6.091,6.091,0,0,0-.256,2.092v6.741a.789.789,0,0,1-.788.789h-5.824a.812.812,0,0,0,0,1.624h5.824a.788.788,0,0,1,.788.788V287.2a.789.789,0,0,1-.788.789h-5.824a.811.811,0,1,0,0,1.623h5.824a.788.788,0,0,1,.788.789v8.956a3.031,3.031,0,0,0,.5,1.952,1.4,1.4,0,0,0,1.162.471,1.422,1.422,0,0,0,1.159-.482,2.951,2.951,0,0,0,.5-1.94V290.4A.789.789,0,0,1,435.854,289.615Zm18.507,6.268a.79.79,0,0,1-.658-.355l-3.1-4.69a.79.79,0,0,1,.658-1.223h3.1a.788.788,0,0,1,.788.789v4.69a.792.792,0,0,1-.561.756A.81.81,0,0,1,454.361,295.883Zm-1.633-4.691.845,1.278v-1.278Zm1.633-3.2h-5.214a.787.787,0,0,1-.658-.354l-3.736-5.654a.789.789,0,0,1,.657-1.223h8.951a.789.789,0,0,1,.788.789V287.2A.788.788,0,0,1,454.361,287.991Zm-4.79-1.577h4v-4.077h-6.7Zm-5.792,1.577h-7.925a.789.789,0,0,1-.789-.788v-5.654a.789.789,0,0,1,.789-.788h4.238a.787.787,0,0,1,.66.358l3.688,5.654a.787.787,0,0,1-.661,1.218Zm-7.137-1.577h5.681l-2.659-4.077h-3.022ZM438,279.138h-2.149a.789.789,0,0,1-.789-.789v-3.3a.789.789,0,0,1,1.449-.431l2.15,3.3a.789.789,0,0,1-.661,1.22Z"
                          fill="#c10000"
                        />
                      </g>
                    </g>
                  </g>
                </svg>
                <!-- <MainIcon name="naira" class="ref-user__naira" /> -->
                <span class="ref-user__text">{{ getReferralDetails.totalAmount }}</span>
              </p>
            </div>
          </div>
          <MainIcon name="gift-card" size="retain" />
        </div>
        <div class="ref-user__summary">
          <div>
            Total Sign Ups
            <p class="ref-user__text">{{ getReferralDetails.totalSignUps }}</p>
          </div>
          <div>
            Sign Ups that invested
            <p class="ref-user__text">{{ getReferralDetails.investedSignUps }}</p>
          </div>
        </div>
      </div>
      <div class="ref-user__col">
        <div class="ref-user__main ref-user__main--referral">
          <div>
            <p class="ref-user__alt-text">Your Referral code</p>
            <p class="ref-user__text">{{ getReferralDetails.referralCode }}</p>
          </div>
          <div>
            <div class="ref-user__share-div">SHARE INVITE LINK</div>
            <MainIcon name="socials" size="retain" :refText="refText" :refLink="getReferralDetails.referralLink" />
          </div>
        </div>
        <div>
          <p class="ref-user__alt-text or-text">OR</p>
          <p class="ref-user__alt-text">Copy referral message and link <span>(tap message to copy)</span></p>
          <div class="ref-tooltip">
            <span class="ref-tooltip__text">{{ tooltipText }}</span>
            <div class="ref-user__message-box" tabindex="0" @click="copyText" @blur="revertText">{{ refText }} {{ getReferralDetails.referralLink }}</div>
          </div>
        </div>
      </div>
    </div>
    <div class="trans ref-trans">
      <div class="trans__row ref-trans__heading">
        <div :class="['trans__head', { 'trans__head--mbl-hide': isTableToggled }]">date</div>
        <div :class="['trans__head', 'trans__head--lg', { 'trans__head--mbl-hide': isTableToggled }]">name</div>
        <div :class="['trans__head', 'trans__head--lg', { 'trans__head--mbl-hide': isTableToggled }]">project</div>
        <div :class="['trans__head', { 'trans__head--mbl-hide': !isTableToggled }]">commission</div>
        <div :class="['trans__head', { 'trans__head--mbl-hide': !isTableToggled }]">status</div>
        <MainIcon name="right-caret" :class="['trans__caret', 'trans__caret--right', { 'trans__caret--hidden': isTableToggled }]" @click="toggleTable" />
        <MainIcon name="left-caret" :class="['trans__caret', 'trans__caret--left', { 'trans__caret--hidden': !isTableToggled }]" @click="toggleTable" />
      </div>
      <ReferTransaction :is-toggled="isTableToggled" />
      <ReferTransaction name="john doe" :commission="7500" status="invested" :is-toggled="isTableToggled" />
      <ReferTransaction name="Inwuosu njeakor" project="flutterwave investment" :is-toggled="isTableToggled" />
      <ReferTransaction name="ogbeni agba" :is-toggled="isTableToggled" />
      <div class="trans__pagination">
        <button type="button" class="trans__btn trans__btn--lg">Previous</button>
        <button type="button" class="trans__btn" :class="{ 'trans__btn--active': num === 1 }" v-for="num in 4" :key="num">
          {{ num }}
        </button>
        <button type="button" class="trans__btn trans__btn--lg">Next</button>
      </div>
    </div>
  </div>
</template>

<script>
import ReferTransaction from "@/components/users/ReferTransaction.vue";
import MainIcon from "@/components/Shared/mainIcon.vue";
import { mapActions, mapGetters } from "vuex";

export default {
  name: "ReferAndEarn",
  data() {
    return {
      tooltipText: "Copy to clipboard",
      refText: "I use myyinvest to invest securely, sign up with my link and get started on your investment journey with secured and guaranteed ROI",
      isTableToggled: false
    };
  },
  components: {
    ReferTransaction,
    MainIcon
  },
  methods: {
    ...mapActions(["fetchReferralDetails"]),
    async copyText($event) {
      await navigator.clipboard.writeText($event.target.textContent);
      this.tooltipText = "Text Copied!";
    },
    revertText() {
      this.tooltipText = "Copy to clipboard";
    },
    toggleTable() {
      this.isTableToggled = !this.isTableToggled;
    }
  },
  computed: {
    ...mapGetters(["getReferralDetails", "getReferredUsers"])
  },
  created() {
    this.fetchReferralDetails();
  }
};
</script>
